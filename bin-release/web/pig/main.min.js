var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Pig=function(t){function e(e){var i=t.call(this)||this;return i.game=e,i.walkY=0,i.dropStop=!0,i.jumpCount=0,i.overStatus=!1,i.jumpStatus=!1,i.isRepeat=!0,i.overRunStatus=!1,i.init(),i}return __extends(e,t),e.prototype.init=function(){this.x=config.pigX,this.y=config.height-config.groundInit,this.width=51,this.rightLine=this.x+this.width+config.pigDeviation;var t=new egret.MovieClipDataFactory(RES.getRes("pig"),RES.getRes("pig_png"));this.move=new egret.MovieClip(t.generateMovieClipData("run")),this.addChild(this.move)},e.prototype.jump=function(){var t=this;this.jumpCount>=config.jumpCount||this.overStatus||(this.game.home.music.jumpMusic(),this.jumpCount+=1,egret.Tween.removeTweens(this),this.jumpStatus=this.dropStop=!0,egret.Tween.get(this,{loop:!1}).to({y:this.y-config.jumpHeight},400,egret.Ease.sineOut).call(function(){t.dropStop=!1}))},e.prototype.drop=function(){var t=this;this.overRunStatus=!1,clearTimeout(this.dropTime),this.dropTime=setInterval(function(){if(!t.overStatus&&(t.game.isDrops()||t.dropStop||t.game.stopTween))return void(t.dropStop=!1);t.overStatus&&(t.isRepeat||Math.abs(t.walkY-t.y)>6&&0==t.jumpCount)&&(t.over(),t.overStatus=!0,t.isRepeat=!1);var e=t.y+config.height*(config.height>1920?.009:.008);return e>=config.height?(t.overStatus=!0,t.y=config.height,!t.overRunStatus&&t.isRepeat&&t.over(),void clearInterval(t.dropTime)):void(t.y=e)},6)},e.prototype.isOver=function(){var t=this.game.ground,e=!0;return t.$children.map(function(t,i){t.collisionStatus&&(e=!1)}),e},e.prototype.over=function(){console.log("进入死亡"),this.game.resetStatus=!0,this.overRunStatus=!0;config.height+this.height;clearTimeout(this.game.gold.goidTime),clearTimeout(this.game.monster.dragonTime),this.game.monster.$children.map(function(t,e){t.$children[0].stop()}),egret.Tween.removeAllTweens(),this.game.gameOver()},e}(egret.DisplayObjectContainer);__reflect(Pig.prototype,"Pig");var config={logo:"",moreGame:"http://wx.xiaomaichang.net",complaintsAddress:"http://www.xiaomaichang.net/other/complain",HeadImage:egret.Texture,nickName:"",width:1080,height:1920,pigX:300,pigDeviation:10,initHeight:288,jumpHeight:400,jumpCount:2,jumpMaxGroundDeviation:100,jumpGroundDeviation:250,groundInit:520,groundXmax:1006,groundXmin:450,groundYmax:600,groundYmin:312,monsterYmax:950,monsterYmin:700,distance:500,dragonShowTime:2500,dragonStartTime:5e3,balloonMax:254,balloonMin:520,balloonX:200,goidMax:500,lotteryCount:5,lotteryTime:300,lotteryAngle:30,probabilityLogo:.1,goidUpTurn:.7,goidDownTurn:.3,goidTopPos:100},Clearing=function(t){function e(e){var i=t.call(this)||this;return i.game=e,i.clearingMask=new egret.Shape,i.x=i.y=0,i.width=config.width,i.height=config.height,i.init(),i}return __extends(e,t),e.prototype.init=function(){this.clearingMask.graphics.beginFill(0,.8),this.clearingMask.graphics.drawRect(0,0,config.width,config.height),this.clearingMask.graphics.endFill(),this.clearingMask.visible=!1,this.addChild(this.clearingMask),this.success=this.frame("clearingOkBg"),this.failure=this.frame("clearingNoBg"),this.lotteryWin=this.resultFrame({title:"lotteryResultWinTitle",pig:"winPig",text:"您真幸运！\n恭喜获得#元优惠券\n点击以下链接领取\n************************"}),this.lotteryLose=this.resultFrame({title:"lotteryResultLoseTitle",pig:"losePig",text:"没中呐，再接再厉哦！\n换个姿势试试~"})},e.prototype.frame=function(t){var e=new egret.DisplayObjectContainer;e.width=840,e.height=1186,e.x=121,e.y=(config.height-e.height)/2,e.visible=!1;var i=new egret.Bitmap(RES.getRes(t));i.x=i.y=0,i.width=840,i.height=1185;var n=new egret.Bitmap(RES.getRes("close"));n.x=750,n.y=-120,n.visible=!1,n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePopup,this);var o=new egret.DisplayObjectContainer;o.width=840,o.height=220,o.x=o.y=0,e.stars=o,e.addChild(i),"clearingOkBg"==t&&e.addChild(this.setButton("clearingBtn1",135,670,this.lottery)),e.addChild(this.setButton("clearingBtn2",135,"clearingOkBg"==t?834:740,this.game.reset,this.game)),e.addChild(this.setButton("clearingBtn3",135,"clearingOkBg"==t?1002:904,function(){window.top.location.href=config.moreGame}));var r=this.setText(e);return e.label=r.label,e.prompt=r.prompt,e.addChild(o),e.addChild(n),this.addChild(e),e},e.prototype.setButton=function(t,e,i,n,o){void 0===o&&(o=this);var r=new egret.Bitmap(RES.getRes(t));return r.x=e,r.y=i,r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,n,o),r},e.prototype.setText=function(t){var e=new egret.TextField,i=new egret.TextField;return e.text="获得30分！",e.textColor=i.textColor=16776560,e.size=60,e.width=i.width=632,e.height=85,e.x=i.x=104,e.y=446,e.textAlign=i.textAlign="center",e.verticalAlign=i.verticalAlign="center",i.text="今天还有5次抽奖机会",i.size=40,i.height=64,i.y=542,t.addChild(e),t.addChild(i),{label:e,prompt:i}},e.prototype.setStar=function(t,e){if(e.stars.removeChildren(),!(0>=t)){t>3&&(t=3);for(var i=0;t>i;i++){var n=new egret.Bitmap(RES.getRes("star"));n.x=126+201*i,n.y=18,n.width=181,n.height=176,e.stars.addChild(n)}}},e.prototype.lottery=function(){this.failure.visible=this.success.visible=!1;var t=new egret.Bitmap(RES.getRes("lotteryGift"));t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=config.width/2,t.y=config.height/2,this.addChild(t),this.lotteryTween(t,config.lotteryTime,-config.lotteryAngle,!0)},e.prototype.lotteryTween=function(t,e,i,n){var o=this;void 0===n&&(n=!1),egret.Tween.get(t,{loop:!1}).to({rotation:i},n?e/2:e).call(function(){return 100>=e?(o.removeChild(t),void(o.lotteryWin.visible=!0)):void o.lotteryTween(t,e-30,0>i?config.lotteryAngle:-config.lotteryAngle)})},e.prototype.resultFrame=function(t){var e=new egret.DisplayObjectContainer;e.width=842,e.height=1139,e.x=121,e.y=(config.height-e.height)/2,e.visible=!1;var i=new egret.Bitmap(RES.getRes("lotteryResultBg"));i.width=842,i.height=801;var n=new egret.Bitmap(RES.getRes("lotteryResultClose"));n.x=750,n.y=-110,n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePopup,this);var o=new egret.Bitmap(RES.getRes(t.title));o.x=(e.width-o.width)/2,o.y=76;var r=new egret.Bitmap(RES.getRes(t.pig));r.x=(e.width-r.width)/2,r.y=775-r.height;var a=new egret.TextField;return a.text=t.text,a.lineSpacing=16,a.textAlign="center",a.textColor=8795392,a.size=46,a.width=842,a.x=0,a.y=270,e.addChild(i),e.addChild(o),e.addChild(n),e.addChild(a),e.addChild(r),e.addChild(this.setButton("clearingBtn2",137,840,this.game.reset,this.game)),e.addChild(this.setButton("clearingBtn3",137,1009,function(){window.top.location.href=config.moreGame})),this.addChild(e),e},e.prototype.showSuccess=function(){this.clearingMask.visible=!0,this.failure.visible=!1,this.success.visible=!0,this.success.label.text="获得"+this.game.head.schedule+"分",this.success.prompt.text="今天还有"+config.lotteryCount+"次抽奖机会",this.setStar(Math.floor(this.game.head.schedule/config.goidMax),this.success)},e.prototype.showFailure=function(){this.clearingMask.visible=!0,this.success.visible=!1,this.failure.visible=!0,this.failure.label.text="获得"+this.game.head.schedule+"分",this.failure.prompt.text="需要达到"+config.goidMax+"分才能抽奖哦",this.setStar(0,this.failure)},e.prototype.closePopup=function(){this.clearingMask.visible=this.lotteryWin.visible=this.lotteryLose.visible=this.success.visible=this.failure.visible=!1},e}(egret.DisplayObjectContainer);__reflect(Clearing.prototype,"Clearing");var Game=function(t){function e(e){var i=t.call(this)||this;return i.home=e,i.visible=!1,i.stopTween=!0,i.pig=new Pig(i),i.ground=new Ground(i),i.gold=new Gold(i),i.monster=new Monster(i),i.head=new Head(i),i.result=new Result(i),i.resetStatus=!1,i}return __extends(e,t),e.prototype.init=function(){var t=this;return this.backView("pigBg"),this.addChild(this.ground),this.setBalloon(),this.addChild(this.gold),this.addChild(this.pig),this.addChild(this.monster),this.jumpEvent(),this.addChild(this.head),this.backView("grass"),this.addChild(this.result),this.tutorial(),setTimeout(function(){t.pig.drop()},100),!0},e.prototype.backView=function(t){var e=new egret.Bitmap(RES.getRes(t));e.x=0,e.y=config.height-e.height,this.addChild(e)},e.prototype.tutorial=function(){var t=this;if(-1!=document.cookie.indexOf("tutorial"))return void this.start();var e=new egret.Bitmap(RES.getRes("gamePrompt"));e.width=config.width,e.height=config.height,e.x=e.y=0,e.visible=!0,e.touchEnabled=!0,this.addChild(e),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){var i=new Date;i.setDate(i.getDate()+3e3),document.cookie="tutorial=true;expires="+i.toGMTString(),t.start(),e.visible=!1},this)},e.prototype.setBalloon=function(){var t=new egret.Bitmap(RES.getRes("balloon"));t.x=t.y=0;var e=new egret.Bitmap(this.logo);e.width=e.height=96,e.x=10,e.y=208;var i=new egret.DisplayObjectContainer;i.width=t.width,i.height=t.height,i.x=config.balloonX,i.y=config.balloonMin,i.addChild(t),i.addChild(e),this.addChild(i),this.balloon=i},e.prototype.balloonTween=function(t){var e=this;egret.Tween.get(t,{loop:!1}).to({y:t.y==config.balloonMax?config.balloonMin:config.balloonMax},1700).call(function(){e.balloonTween(t)})},e.prototype.jumpEvent=function(){var t=new egret.Shape;t.x=t.y=0,t.graphics.beginFill(2455042,0),t.graphics.drawRect(0,0,config.width,config.height),t.graphics.endFill(),t.touchEnabled=!0,this.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.pig.jump,this.pig)},e.prototype.isDrop=function(t){var e=t.x+t.width,i=t.x<=this.pig.rightLine&&e>this.pig.x,n=this.pig.y+this.pig.height;return i&&n>=t.y&&n<=t.y+60?!0:!1},e.prototype.isDrops=function(){for(var t=this.ground.$children,e=0;e<t.length;e++)if(this.isDrop(t[e]))return!0;return!1},e.prototype.gameOver=function(){var t=this;$.ajax({type:"post",url:xmlConfig.over,contentType:"application/json",dataType:"json",data:JSON.stringify({Score:this.head.schedule}),xhrFields:{withCredentials:!0},success:function(t){}}),setTimeout(function(){t.resetStatus=!0,t.result.show()},1e3)},e.prototype.start=function(){clearInterval(this.stopTime),this.home.music.startMusic(),this.visible=!0,this.stopTween=!1,egret.Tween.resumeTweens(this.ground.$children[0]),this.pig.move.gotoAndPlay(1,-1),this.pig.y=config.height-config.initHeight-this.pig.height,this.gold.init(),this.monster.init(),this.balloon.y=config.balloonMin,this.balloonTween(this.balloon),this.head.schedule=0,this.head.removeChildren(),this.head.init()},e.prototype.stopTimeout=function(){clearTimeout(this.gold.goidTime),clearTimeout(this.gold.goidTime2),clearTimeout(this.monster.dragonTime),clearTimeout(this.head.barrageTime)},e.prototype.reset=function(){var t=this;this.home.music.resetMusic(),this.stopTween=this.resetStatus=!0,this.stopTime=setInterval(function(){t.stopTimeout()},40),egret.Tween.removeAllTweens(),this.ground.removeChildren(),this.monster.removeChildren(),this.gold.removeChildren(),this.head.removeChildren(),this.pig.overStatus=!1,this.pig.isRepeat=!0,this.pig.x=config.pigX,this.resetStatus=!1,this.head.barrageStatus=!0,this.ground.init(),setTimeout(function(){t.monster.init()},config.dragonStartTime),this.gold.init(),this.pig.drop(),this.result.hide(),this.home.cover.visible=!0,this.home.cover.startTween(),this.visible=!1,this.head.schedule=0},e}(egret.DisplayObjectContainer);__reflect(Game.prototype,"Game");var Gold=function(t){function e(e){var i=t.call(this)||this;return i.game=e,i.x=0,i.y=0,i}return __extends(e,t),e.prototype.init=function(t){var e=this;if(void 0===t&&(t=!1),clearTimeout(this.goidTime),!this.game.resetStatus){var i=t;this.goidTime=setInterval(function(){return e.random=Math.random(),e.random<config.probabilityLogo&&!i?(e.goldMain(),void(e.goidTime2=setTimeout(function(){e.init()},80))):void e.goldMain()},160)}},e.prototype.setGoid=function(){var t=new egret.Bitmap(RES.getRes("coin")),e=this.game.ground.$children[this.game.ground.$children.length-1],i=e.width+e.x-config.width;return 0>i?!1:(t.x=config.width,t.y=e.y-t.height-30,t)},e.prototype.setLogoGoid=function(){var t=new egret.DisplayObjectContainer,e=this.game.ground.$children[this.game.ground.$children.length-1],i=e.width+e.x-config.width;if(0>i)return!1;t.width=t.height=120,t.x=config.width,t.y=e.y-t.height-30;var n=new egret.Bitmap(RES.getRes("goidLogo"));n.width=n.height=120,n.x=n.y=0;var o=new egret.Bitmap(this.game.logo);return o.width=o.height=96,o.x=o.y=12,t.addChild(n),t.addChild(o),t},e.prototype.goldMain=function(){var t=this,e=this.random<config.probabilityLogo?this.setLogoGoid():this.setGoid();if(e){var i=this.game.pig,n=e.y+e.height;this.addChild(e);egret.Tween.get(e,{loop:!1,onChange:function(){var o=e.x+e.width,r=i.y+i.height,a=e.x<t.game.pig.rightLine&&e.x>i.x||o<t.game.pig.rightLine&&o>i.x,s=e.y<r&&e.y>i.y||r>n&&n>i.y;a&&s&&t.pigGetGoid(e)}}).to({x:-e.width},e.constructor===egret.Bitmap?1700:1780).call(function(){t.removeChild(e)})}},e.prototype.pigGetGoid=function(t){var e=this,i=t.constructor===egret.Bitmap,n=new egret.BitmapText;this.game.home.music.goidMusic(),n.font=RES.getRes("font"),n.text=i?"10":"50",n.x=t.x,n.y=t.y-80,this.addChild(n),this.game.head.setLine(i?10:50),egret.Tween.get(n,{loop:!1}).to({y:n.y-90,alpha:0},500).call(function(){e.removeChild(n)}),egret.Tween.removeTweens(t),this.removeChild(t)},e}(egret.DisplayObjectContainer);__reflect(Gold.prototype,"Gold");var Ground=function(t){function e(e){var i=t.call(this)||this;return i.game=e,i.groundPos=[],i.init(),i}return __extends(e,t),e.prototype.init=function(){var t={width:config.width+config.width/2,height:config.initHeight,x:0,y:config.height-config.initHeight,deviation:config.jumpGroundDeviation+config.jumpMaxGroundDeviation*Math.random()};this.game.pig.walkY=this.game.pig.y=config.height-config.initHeight-this.game.pig.height;config.jumpGroundDeviation+config.jumpMaxGroundDeviation*Math.random();this.randomPos(),this.groundMain(t,!0)},e.prototype.randomPos=function(){var t=config.groundXmin+(config.groundXmax-config.groundXmin)*Math.random(),e=config.groundYmin+(config.groundYmax-config.groundYmin)*Math.random(),i={width:t,height:e,x:config.width,y:config.height-e,deviation:config.jumpGroundDeviation+config.jumpMaxGroundDeviation*Math.random()};return 2==this.groundPos.length&&this.groundPos.splice(0,1),this.groundPos.push(i),this.groundPos[0]},e.prototype.setGound=function(t){var e=new egret.DisplayObjectContainer;e.width=t.width,e.height=t.height,e.x=t.x,e.y=config.height-t.height;var i=new egret.Shape;i.x=i.y=0,i.graphics.beginFill(10832440,1),i.graphics.drawRect(0,0,t.width,t.height),i.graphics.endFill();var n=new egret.Bitmap(RES.getRes("groundHeadBg"));return n.width=t.width,n.height=95,n.x=n.y=0,n.fillMode=egret.BitmapFillMode.REPEAT,e.addChild(i),e.addChild(n),this.addChild(e),e},e.prototype.groundMain=function(t,e){var i=this,n=!1,o=this.setGound(t),r=this.game.pig;if(!this.game.resetStatus){egret.Tween.get(o,{loop:!1,onChange:function(){var e=o.x+o.width,a=o.x<=r.rightLine&&e>r.x,s=r.y+r.height;return a&&s>=o.y&&s<=o.y+60&&!r.overStatus?(r.walkY=r.y=o.y-r.height,r.jumpStatus=!1,r.jumpCount=0):r.jumpstatus&&r.dropStop&&(r.dropStop=!1),n||i.game.resetStatus?void 0:e-config.width<=-t.deviation?(i.groundMain(i.randomPos()),void(n=!0)):void 0},onChangeObj:o}).to({x:-t.width},1.481*(e?t.width:t.width+config.width)).call(function(){i.removeChild(o)});this.game.stopTween&&egret.Tween.pauseTweens(o)}},e}(egret.DisplayObjectContainer);__reflect(Ground.prototype,"Ground");var Head=function(t){function e(e){var i=t.call(this)||this;return i.game=e,i.schedule=0,i.barrageStatus=!0,i.x=0,i.y=0,i}return __extends(e,t),e.prototype.init=function(){this.avatar(),this.line()},e.prototype.avatar=function(){var t=new egret.DisplayObjectContainer;t.width=t.height=150,t.x=20,t.y=36;var e=new egret.Shape;e.x=e.y=0,e.graphics.beginFill(16033),e.graphics.drawCircle(75,75,80),e.graphics.endFill();var i=new egret.Bitmap(config.HeadImage);i.x=i.y=4,i.width=i.height=142;var n=new egret.Shape;n.graphics.beginFill(255),n.graphics.drawCircle(75,75,71),n.graphics.endFill(),i.mask=n,t.addChild(e),t.addChild(i),t.addChild(n),this.addChild(t)},e.prototype.line=function(){var t=new egret.DisplayObjectContainer;t.width=690,t.height=178,t.x=218,t.y=10;var e=new egret.Shape;e.graphics.lineStyle(2,16033),e.graphics.beginFill(13430783),e.graphics.drawRoundRect(0,73,660,60,60),e.graphics.endFill();var i=new egret.Shape;i.graphics.beginFill(10671082),i.graphics.drawRoundRect(10,83,640,40,40),i.graphics.endFill();var n=new egret.Bitmap(RES.getRes("line"));n.x=10,n.y=83,n.width=640,n.height=40,this.scheduleMask=new egret.Shape,this.scheduleMask.graphics.beginFill(10832440,1),this.scheduleMask.graphics.drawRect(10,83,0,40),this.scheduleMask.graphics.endFill(),n.mask=this.scheduleMask;var o=new egret.Bitmap(RES.getRes("gift"));o.x=599,o.y=0,o.width=80,o.height=100,this.startText=new egret.BitmapText,this.startText.font=RES.getRes("font"),this.startText.text="0",this.startText.x=0,this.startText.y=141;var r=new egret.BitmapText;r.font=RES.getRes("font"),r.text=config.goidMax.toString(),r.x=690-r.width-28,r.y=141,t.addChild(e),t.addChild(this.startText),t.addChild(r),t.addChild(i),t.addChild(n),t.addChild(this.scheduleMask),t.addChild(o),this.addChild(t)},e.prototype.barrage=function(t){var e=this,i=new egret.Bitmap(RES.getRes(t));i.x=config.width,i.y="barrage1"==t?400:800,this.addChild(i),egret.Tween.get(i,{loop:!1}).to({x:-i.width},"barrage1"==t?8e3:4600).call(function(){"barrage1"==t&&(e.barrageTime=setTimeout(function(){e.barrage("barrage2")},3e3))})},e.prototype.setLine=function(t){return this.startText.text=this.schedule.toString(),this.schedule>config.goidMax?(this.schedule+=t,void(this.barrageStatus&&(this.barrageStatus=!1,this.barrage("barrage1")))):(this.schedule+=t,this.scheduleMask.graphics.clear(),this.scheduleMask.graphics.beginFill(10832440,1),this.scheduleMask.graphics.drawRect(10,83,640*(this.schedule/config.goidMax),40),void this.scheduleMask.graphics.endFill())},e}(egret.DisplayObjectContainer);__reflect(Head.prototype,"Head");var Monster=function(t){function e(e){var i=t.call(this)||this;return i.game=e,i.collisionStatus=!0,i}return __extends(e,t),e.prototype.init=function(){var t=this;clearTimeout(this.dragonTime),this.dragonTime=setTimeout(function(){t.removeChildren(),t.setMonster()},config.dragonStartTime)},e.prototype.setMonster=function(){if(!this.game.resetStatus){var t=new egret.DisplayObjectContainer;t.width=190,t.height=176,t.x=config.width+190,t.y=config.height-config.monsterYmax,this.addChild(t);var e=new egret.MovieClipDataFactory(RES.getRes("dragon"),RES.getRes("dragon_png")),i=new egret.MovieClip(e.generateMovieClipData("run"));t.addChild(i),i.gotoAndPlay(1,-1),this.collisionStatus=!0,this.monsterTween(t)}},e.prototype.monsterTween=function(t){var e=this;this.game.resetStatus||egret.Tween.get(t,{loop:!1,onChange:function(){if(!e.game.resetStatus){if(t.x<=-t.width)return egret.Tween.removeTweens(t),e.removeChild(t),void(e.dragonTime=setTimeout(function(){e.setMonster()},config.dragonShowTime));if(e.collisionStatus&&e.detectCollision(t)){if(e.collisionStatus=!1,e.detectStepOn(t))return void e.dragonOver(t);e.game.pig.overStatus=!0}}},onChangeObj:t}).to({y:config.height-(config.height-t.y==config.monsterYmax?config.monsterYmin:config.monsterYmax),x:t.x-config.distance},700).call(function(){e.monsterTween(t)})},e.prototype.countData=function(t){var e=this.game.pig;return{pig:e,rightLine:t.x+t.width,bottomLine:t.y+t.height,pigRightLine:e.x+e.width,pigBottomLine:e.y+e.height}},e.prototype.detectCollision=function(t){if(!this.game.resetStatus){var e,i,n,o,r,a=this.countData(t);e=a.pig,i=a.rightLine,n=a.bottomLine,o=a.pigRightLine,r=a.pigBottomLine;var s=t.x<=o&&i>=o||t.x<=e.x&&i>=e.x,h=t.y<=r&&n>=r||t.y<=e.y&&n>=e.y;return s&&h?!0:!1}},e.prototype.detectStepOn=function(t){if(!this.game.resetStatus){var e,i,n,o,r,a=this.countData(t);return e=a.pig,i=a.rightLine,n=a.bottomLine,o=a.pigRightLine,r=a.pigBottomLine,Math.abs(r-t.y)<30?!0:!1}},e.prototype.dragonOver=function(t){var e=this;this.game.resetStatus||(this.game.pig.jumpCount=config.jumpCount-1,egret.Tween.removeTweens(t),this.dragonTime=setTimeout(function(){egret.Tween.get(t,{loop:!1}).to({y:config.height+t.height,x:t.x-300},700).call(function(){e.removeChild(t),e.dragonTime=setTimeout(function(){e.setMonster()},config.dragonShowTime)})}))},e}(egret.DisplayObjectContainer);__reflect(Monster.prototype,"Monster");var xmlConfig={init:"http://pig.xiaomaichang.net/api/game/init",over:"http://pig.xiaomaichang.net/api/game/over",ranking:"http://pig.xiaomaichang.net/api/game/top"},Result=function(t){function e(e){var i=t.call(this)||this;return i.game=e,i.visible=!1,i.popMask=new egret.Shape,i.init(),i}return __extends(e,t),e.prototype.init=function(){this.maskSet(),this.resultView()},e.prototype.maskSet=function(){this.popMask.graphics.beginFill(0,.8),this.popMask.graphics.drawRect(0,0,config.width,config.height),this.popMask.graphics.endFill(),this.popMask.visible=!1,this.addChild(this.popMask)},e.prototype.show=function(){this.fraction.text="获得"+this.game.head.schedule+"分",this.popMask.visible=this.visible=!0},e.prototype.hide=function(){this.popMask.visible=this.visible=!1},e.prototype.resultView=function(){this.container=new egret.DisplayObjectContainer,this.container.width=840,this.container.height=1026,this.container.x=120,this.container.y=(config.height-1026)/2;var t=new egret.Bitmap(RES.getRes("resultBg"));t.width=840,t.height=1026,t.x=t.y=0,this.container.addChild(t),this.avatarView(this.container),this.setName(this.container),this.setFraction(this.container),this.renewGame(this.container),this.moreGame(this.container),this.addChild(this.container)},e.prototype.avatarView=function(t){var e=new egret.DisplayObjectContainer;e.width=e.height=232,e.x=304,e.y=64;var i=new egret.Bitmap(config.HeadImage);i.x=i.y=0,i.width=i.height=232;var n=new egret.Shape;n.graphics.beginFill(255),n.graphics.drawCircle(116,116,116),n.graphics.endFill(),i.mask=n,e.addChild(n),e.addChild(i),t.addChild(e)},e.prototype.setName=function(t){var e=new egret.TextField;e.text=config.nickName,e.textColor=16777215,e.size=48,e.x=0,e.y=330,e.width=840,e.textAlign="center",t.addChild(e)},e.prototype.setFraction=function(t){var e=new egret.TextField;e.text="获得0分",e.width=632,e.size=60,e.textColor=16776560,e.textAlign="center",e.x=104,e.y=496,this.fraction=e,t.addChild(e)},e.prototype.renewGame=function(t){var e=new egret.Bitmap(RES.getRes("clearingBtn2"));e.x=137,e.y=675,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.game.reset,this.game),t.addChild(e)},e.prototype.moreGame=function(t){var e=new egret.Bitmap(RES.getRes("clearingBtn3"));e.x=137,e.y=844,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){window.top.location.href=config.moreGame},this),t.addChild(e)},e}(egret.DisplayObjectContainer);__reflect(Result.prototype,"Result");var Home=function(t){function e(){var e=t.call(this)||this;return e.resetStart=!1,e.music=new Music(e),e.musicStatus=!0,$.ajax({type:"get",url:xmlConfig.init,dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){config.logo=t.Logo,window.top.document.querySelector("title").innerHTML=t.Title,document.querySelector(".loding").style.display="none",config.nickName=t.User.NickName,RES.getResByUrl(t.User.HeadImage,function(t){config.HeadImage=t,e.game=new Game(e),e.cover=new Cover(e),e.init()},e,RES.ResourceItem.TYPE_IMAGE)},error:function(t,e,i){""!=t.responseText&&(window.location.href=JSON.parse(t.responseText).oauthUrl)}}),e}return __extends(e,t),e.prototype.init=function(){var t=this;this.addChild(this.game),this.addChild(this.cover),RES.getResByUrl(config.logo,function(e){t.game.logo=t.cover.logo=e,t.cover.init()},this,RES.ResourceItem.TYPE_IMAGE)},e.prototype.start=function(){return this.cover.visible=!1,this.game.visible=!0,this.resetStart?void this.game.start():void(this.resetStart=this.game.init())},e}(egret.DisplayObjectContainer);__reflect(Home.prototype,"Home");var Main=function(t){function e(){var e=t.call(this)||this;return config.height=document.querySelector("canvas").height,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},e.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.addChild(new Home))},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.startAnimation=function(t){var e=this,i=new egret.HtmlTextParser,n=t.map(function(t){return i.parse(t)}),o=this.textfield,r=-1,a=function(){r++,r>=n.length&&(r=0);var t=n[r];o.textFlow=t;var i=egret.Tween.get(o);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(a,e)};a()},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Music=function(t){function e(e){var i=t.call(this)||this;return i.home=e,i.bgm=new egret.Sound,i.jump=new egret.Sound,i.goid=new egret.Sound,i.init(),i}return __extends(e,t),e.prototype.init=function(){this.bgm.load("resource/assets/music/bgm.mp3"),this.jump.load("resource/assets/music/jump.mp3"),this.goid.load("resource/assets/music/goid.mp3")},e.prototype.startMusic=function(){this.bgmSoundChannel&&this.bgmSoundChannel.stop(),this.playMusic(this.bgm,"bgmSoundChannel")},e.prototype.jumpMusic=function(){this.jumpSoundChannel&&this.jumpSoundChannel.stop(),this.playMusic(this.jump,"jumpSoundChannel",1)},e.prototype.goidMusic=function(){var t=this;setTimeout(function(){t.goidSoundChannel&&t.goidSoundChannel.stop(),t.playMusic(t.goid,"goidSoundChannel",1)})},e.prototype.stopAll=function(){},e.prototype.playMusic=function(t,e,i){var n=this;void 0===i&&(i=0),this.home.musicStatus&&(window.top.WeixinJSBridge?window.top.WeixinJSBridge.invoke("getNetworkType",{},function(o){n[e]=t.play(0,i)}):this[e]=t.play(0,i))},e.prototype.resetMusic=function(){this.bgmSoundChannel&&this.bgmSoundChannel.stop(),this.goidSoundChannel&&this.goidSoundChannel.stop(),this.jumpSoundChannel&&this.jumpSoundChannel.stop()},e}(egret.DisplayObjectContainer);__reflect(Music.prototype,"Music");var Activity=function(t){function e(e){var i=t.call(this)||this;return i.cover=e,i.visible=!1,i.popMask=new egret.Shape,i.container=new egret.DisplayObjectContainer,i.activityBtn=new egret.Shape,i.prizeBtn=new egret.Shape,i.init(),i}return __extends(e,t),e.prototype.init=function(){this.popMask.graphics.beginFill(0,.8),this.popMask.graphics.drawRect(0,0,config.width,config.height),this.popMask.graphics.endFill(),this.popMask.visible=!0,this.addChild(this.popMask),this.activity=this.popUpView("activityBg"),this.prize=this.popUpView("prizeBg"),this.activity.visible=!0,this.closeView(),this.activityScroll(),this.prizeScroll(),this.button()},e.prototype.button=function(){var t=this;this.activityBtn.graphics.beginFill(0,0),this.activityBtn.graphics.drawRect(this.activity.x+110,this.activity.y+18,288,120),this.activityBtn.graphics.endFill(),this.prizeBtn.graphics.beginFill(0,0),this.prizeBtn.graphics.drawRect(this.activity.x+433,this.activity.y+18,288,120),this.prizeBtn.graphics.endFill(),this.activityBtn.touchEnabled=this.prizeBtn.touchEnabled=!0,this.activityBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.prize.visible=!1,t.activity.visible=!0},this),this.prizeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.activity.visible=!1,t.prize.visible=!0},this),this.addChild(this.activityBtn),this.addChild(this.prizeBtn)},e.prototype.popUpView=function(t){var e=new egret.DisplayObjectContainer;e.width=840,e.height=1185,e.x=119,e.visible=!1,e.y=(config.height-1185)/2;var i=new egret.Bitmap(RES.getRes(t));return i.x=i.y=0,i.width=e.width,i.height=e.height,i.touchEnabled=!0,this.addChild(e),e.addChild(i),e},e.prototype.scrollView=function(){var t=new egret.ScrollView;return t.x=20,t.y=157,t.width=760,t.height=1008,t.verticalScrollPolicy="auto",t},e.prototype.activityScroll=function(){var t=this.scrollView(),e=new egret.TextField;e.text="不可描述的事情即将发生........嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿嘿",e.x=30,e.y=30,e.lineSpacing=12,e.size=42,e.textColor=11478827,e.width=745,e.height+=80,t.setContent(e),this.activity.addChild(t)},e.prototype.prizeScroll=function(){var t=this.scrollView();this.container.x=31,this.container.width=745,t.setContent(this.container);for(var e=0;15>e;e++)this.getlist();this.prize.addChild(t)},e.prototype.getlist=function(){var t=new egret.DisplayObjectContainer;t.x=0,t.width=745,t.height=162,t.touchEnabled=!0;var e=new egret.TextField,i=new egret.TextField;e.text="1、",e.textAlign=i.textAlign="left",e.textColor=i.textColor=11478827,e.size=i.size=42,e.width=100,e.x=0,e.y=i.y=64,i.text="50元优惠券",i.width=386,i.x=80;var n=new egret.Bitmap(RES.getRes("receive"));n.x=470,n.y=35,n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){console.log(e)},this);var o=new egret.Shape;o.graphics.beginFill(12543323,1),o.graphics.drawRect(0,160,t.width,1),o.graphics.endFill(),t.addChild(e),t.addChild(i),t.addChild(n),t.addChild(o),t.y=this.container.height,this.container.height+=t.height,this.container.addChild(t)},e.prototype.closeView=function(){var t=new egret.Bitmap(RES.getRes("close"));
t.x=870,t.y=this.activity.y-120,t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this),this.addChild(t)},e.prototype.close=function(){this.popMask.visible=this.activity.visible=this.prize.visible=this.visible=!1},e}(egret.DisplayObjectContainer);__reflect(Activity.prototype,"Activity");var Cover=function(t){function e(e){var i=t.call(this)||this;return i.home=e,i.ranking=new Ranking(i),i}return __extends(e,t),e.prototype.init=function(){this.backView(),this.complaints(),this.rankingView(),this.more(),this.startView(),this.musicBut(),this.addChild(this.ranking),RES.getResByUrl(config.logo,this.printLogo,this,RES.ResourceItem.TYPE_IMAGE)},e.prototype.backView=function(){var t=new egret.Bitmap(RES.getRes("startCover"));t.width=config.width,t.height=config.height,t.x=t.y=0,this.addChild(t)},e.prototype.complaints=function(){var t=new egret.Bitmap(RES.getRes("complaints"));t.x=30,t.y=.015*config.height,t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){window.top.location.href=config.complaintsAddress},this),this.addChild(t)},e.prototype.activityView=function(){var t=this,e=new egret.Bitmap(RES.getRes("activity"));e.x=702,e.y=.018*config.height,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.activity.visible=t.activity.activity.visible=t.activity.popMask.visible=!0},this),this.addChild(e)},e.prototype.rankingView=function(){var t=this,e=new egret.Bitmap(RES.getRes("leaderboard"));e.x=730,e.y=.018*config.height,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.ranking.show()},this),this.addChild(e)},e.prototype.more=function(){var t=new egret.Bitmap(RES.getRes("more"));t.x=910,t.y=.018*config.height,t.touchEnabled=!0,this.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){window.top.location.href=config.moreGame},this)},e.prototype.gameNumber=function(){var t=new egret.TextField;t.text="已有5000人参加了挑战",t.lineSpacing=70,t.textAlign="center",t.textColor=16711422,t.size=40,t.width=600,t.height=70,t.x=243,t.y=.522*config.height,this.addChild(t)},e.prototype.startView=function(){this.startBtn=new egret.Bitmap(RES.getRes("startBtn")),this.startBtn.anchorOffsetX=this.startBtn.width/2,this.startBtn.anchorOffsetY=this.startBtn.height/2,this.startBtn.x=241+this.startBtn.width/2,this.startBtn.y=.598*config.height,this.startBtn.touchEnabled=!0,this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.home.start,this.home),this.addChild(this.startBtn),this.startTween()},e.prototype.startTween=function(){var t=this,e=1==this.startBtn.scaleX?1.1:1;egret.Tween.get(this.startBtn,{loop:!1}).to({scaleX:e,scaleY:e},600).call(function(){t.startTween()})},e.prototype.printLogo=function(t){var e=new egret.Bitmap(t);e.x=(config.width-e.width)/2,e.y=.685*config.height,this.addChildAt(e,2)},e.prototype.musicBut=function(){var t=this,e=new egret.Bitmap(RES.getRes("musicOn")),i=new egret.Bitmap(RES.getRes("musicOff"));e.x=i.x=.85*config.width,e.y=i.y=.1*config.height,e.touchEnabled=i.touchEnabled=!0,i.visible=!1,e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.home.musicStatus=!1,i.visible=!0,e.visible=!1},this),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.home.musicStatus=!0,i.visible=!1,e.visible=!0},this),this.addChild(e),this.addChild(i)},e}(egret.DisplayObjectContainer);__reflect(Cover.prototype,"Cover");var Ranking=function(t){function e(e){var i=t.call(this)||this;return i.cover=e,i.visible=!1,i.popMask=new egret.Shape,i.containerList=new egret.DisplayObjectContainer,i.init(),i}return __extends(e,t),e.prototype.init=function(){this.maskSet(),this.rankingView()},e.prototype.show=function(){var t=this;$.ajax({type:"get",url:xmlConfig.ranking,dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){t.container.visible=t.visible=!0,t.fraction.text=e.Self.Score,t.rank.text=0==e.Self.Rank?"未上榜":e.Self.Rank,t.setData(e.Top)},error:function(t,e,i){t.status?""!=t.responseText&&(window.location.href=JSON.parse(t.responseText).oauthUrl):window.location.href=window.location.href}})},e.prototype.maskSet=function(){this.popMask.graphics.beginFill(0,.8),this.popMask.graphics.drawRect(0,0,config.width,config.height),this.popMask.graphics.endFill(),this.popMask.visible=!0,this.addChild(this.popMask)},e.prototype.setData=function(t){this.containerList.removeChildren(),this.containerList.height=0;for(var e=0;e<t.length;e++){var i=this.setList({count:e+1,avatarUrl:t[e].HeadImage,name:t[e].NickName,fraction:t[e].Score});i.y=this.containerList.height,this.containerList.height+=i.height,this.containerList.addChild(i)}},e.prototype.rankingView=function(){this.container=new egret.DisplayObjectContainer,this.container.width=860,this.container.height=1260,this.container.x=112,this.container.y=(config.height-1260)/2;var t=new egret.Bitmap(RES.getRes("rankingBg"));t.x=t.y=0,this.container.addChild(t),this.avatarView({container:this.container,x:34,y:28,width:112}),this.scrollView(this.container),this.setName(this.container),this.setClose(this.container),this.setUserData(this.container),this.addChild(this.container)},e.prototype.avatarView=function(t){var e=new egret.DisplayObjectContainer;e.width=e.height=t.width,e.x=t.x,e.y=t.y;var i=new egret.Bitmap(t.avatarUrl||config.HeadImage);i.x=i.y=0,i.width=i.height=t.width;var n=new egret.Shape;n.graphics.beginFill(255),n.graphics.drawCircle(t.width/2,t.width/2,t.width/2),n.graphics.endFill(),i.mask=n,e.addChild(n),e.addChild(i),t.container.addChild(e)},e.prototype.setName=function(t){var e=new egret.TextField;e.text=config.nickName,e.textColor=16777215,e.size=40,e.x=180,e.y=64,t.addChild(e)},e.prototype.setClose=function(t){var e=this,i=new egret.Bitmap(RES.getRes("rankingClose"));i.x=this.container.width-i.width,i.y=-122,i.touchEnabled=!0,t.addChild(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.container.visible=e.visible=!1},this)},e.prototype.setUserData=function(t){var e=new egret.TextField,i=new egret.TextField;e.text="290000",i.text="未上榜",e.textColor=i.textColor=16769124,e.width=i.width=236,e.size=i.size=40,e.x=158,e.y=i.y=190,i.x=570,e.textAlign=i.textAlign="right",this.fraction=e,this.rank=i,t.addChild(e),t.addChild(i)},e.prototype.scrollView=function(t){var e=new egret.ScrollView;e.x=0,e.y=278,e.width=860,e.height=983,e.verticalScrollPolicy="auto",t.addChild(e),this.containerList.width=860,e.setContent(this.containerList)},e.prototype.setList=function(t){var e=this,i=this.returnCountName(t.count),n=new egret.DisplayObjectContainer;n.width=860,n.height=180,n.x=0;var o=new egret.Shape;if(o.graphics.beginFill(t.count%2==0?15923199:16777215),o.graphics.drawRect(0,0,860,180),o.graphics.endFill(),n.addChild(o),i){var r=new egret.Bitmap(RES.getRes(i));r.x=30,r.y=47,n.addChild(r)}else{var a=new egret.Shape;a.graphics.lineStyle(2,15514),a.graphics.drawCircle(64,90,32),a.graphics.endFill();var s=new egret.TextField;s.text=t.count+"",s.textColor=15514,s.size=46,s.x=32,s.y=69,s.width=64,s.textAlign="center",n.addChild(a),n.addChild(s)}RES.getResByUrl(t.avatarUrl,function(t){e.avatarView({container:n,x:128,y:46,width:90,avatarUrl:t})},this,RES.ResourceItem.TYPE_IMAGE);var h=new egret.TextField;h.text=t.name,h.textColor=819,h.size=46,h.x=237,h.y=68,n.addChild(h);var g=new egret.TextField;return g.text=t.fraction+"",g.textColor=819,g.size=46,g.x=541,g.y=73,g.width=278,g.textAlign="right",n.addChild(g),n},e.prototype.returnCountName=function(t){var e;switch(t){case 1:e="rankingOne";break;case 2:e="rankingTwo";break;case 3:e="rankingThree";break;default:e=!1}return e},e}(egret.DisplayObjectContainer);__reflect(Ranking.prototype,"Ranking");